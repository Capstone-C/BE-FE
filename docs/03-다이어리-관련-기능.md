# ë‹¤ì´ì–´ë¦¬ ê´€ë ¨ ê¸°ëŠ¥ (Issue #53)

> **GitHub Issue**: https://github.com/Capstone-C/BE-FE/issues/53  
> **ë‹´ë‹¹ì**: qoweh  
> **PR**: #138, #141 (Merged)

---

## ğŸ“‹ ëª©ì°¨
1. [ê¸°ëŠ¥ ê°œìš”](#1-ê¸°ëŠ¥-ê°œìš”)
2. [ì„œë¸Œ ì´ìŠˆ ëª©ë¡](#2-ì„œë¸Œ-ì´ìŠˆ-ëª©ë¡)
3. [íŒŒì¼ êµ¬ì¡°](#3-íŒŒì¼-êµ¬ì¡°)
4. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#4-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
5. [API ëª…ì„¸](#5-api-ëª…ì„¸)
6. [í•µì‹¬ êµ¬í˜„ ìƒì„¸](#6-í•µì‹¬-êµ¬í˜„-ìƒì„¸)
7. [ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§](#7-ë¹„ì¦ˆë‹ˆìŠ¤-ë¡œì§)
8. [ë””ìì¸ íŒ¨í„´](#8-ë””ìì¸-íŒ¨í„´)
9. [ì˜ˆìƒ ì§ˆë¬¸ ë° ë‹µë³€](#9-ì˜ˆìƒ-ì§ˆë¬¸-ë°-ë‹µë³€)

---

## 1. ê¸°ëŠ¥ ê°œìš”

ì‹ë‹¨ ë‹¤ì´ì–´ë¦¬ëŠ” ì‚¬ìš©ìê°€ ë§¤ì¼ì˜ ì‹ì‚¬ë¥¼ ê¸°ë¡í•˜ê³  ê´€ë¦¬í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥
- ì›”ë³„ ìº˜ë¦°ë” ë·° ì¡°íšŒ
- íŠ¹ì • ë‚ ì§œì˜ ì‹ë‹¨ ëª©ë¡ ì¡°íšŒ
- ì‹ë‹¨ ê¸°ë¡ CRUD (ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ)
- ë ˆì‹œí”¼ë¥¼ ë‹¤ì´ì–´ë¦¬ì— ì¶”ê°€

### íŠ¹ì§•
- í•˜ë£¨ 4ë¼ (ì•„ì¹¨, ì ì‹¬, ì €ë…, ê°„ì‹) ê´€ë¦¬
- ê°™ì€ ë‚ ì§œ + ê°™ì€ ì‹ì‚¬ ì‹œê°„ ì¤‘ë³µ ë°©ì§€
- ë ˆì‹œí”¼ ì—°ë™ìœ¼ë¡œ ê°„í¸í•œ ê¸°ë¡

---

## 2. ì„œë¸Œ ì´ìŠˆ ëª©ë¡

| ì´ìŠˆ | ì œëª© | ìƒíƒœ |
|------|------|------|
| #54 | DIARY-01: ì‹ë‹¨ ë‹¤ì´ì–´ë¦¬ ìº˜ë¦°ë” ë·° | âœ… ì™„ë£Œ |
| #55 | DIARY-02: íŠ¹ì • ë‚ ì§œì˜ ì‹ë‹¨ ëª©ë¡ ì¡°íšŒ | âœ… ì™„ë£Œ |
| #56 | DIARY-03: ì‹ë‹¨ ê¸°ë¡ ì¶”ê°€ | âœ… ì™„ë£Œ |
| #57 | DIARY-04: ì‹ë‹¨ ê¸°ë¡ ìˆ˜ì • | âœ… ì™„ë£Œ |
| #58 | DIARY-05: ì‹ë‹¨ ê¸°ë¡ ì‚­ì œ | âœ… ì™„ë£Œ |
| #59 | DIARY-06: ë ˆì‹œí”¼ë¥¼ ë‹¤ì´ì–´ë¦¬ì— ì¶”ê°€ | âœ… ì™„ë£Œ |

---

## 3. íŒŒì¼ êµ¬ì¡°

```
/CC_BE/src/main/java/com/capstone/web/diary/
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ DiaryController.java           # REST API ì—”ë“œí¬ì¸íŠ¸
â”œâ”€â”€ domain/
â”‚   â””â”€â”€ Diary.java                     # JPA ì—”í‹°í‹°
â”œâ”€â”€ dto/
â”‚   â””â”€â”€ DiaryDto.java                  # ìš”ì²­/ì‘ë‹µ DTO
â”‚       â”œâ”€â”€ CreateRequest              # ìƒì„± ìš”ì²­
â”‚       â”œâ”€â”€ UpdateRequest              # ìˆ˜ì • ìš”ì²­
â”‚       â”œâ”€â”€ Response                   # ë‹¨ì¼ ì‘ë‹µ
â”‚       â”œâ”€â”€ MonthlyCalendarResponse    # ì›”ë³„ ìº˜ë¦°ë” ì‘ë‹µ
â”‚       â””â”€â”€ DailyEntry                 # ì¼ë³„ ìš”ì•½
â”œâ”€â”€ exception/
â”‚   â”œâ”€â”€ DiaryErrorCode.java            # ì—ëŸ¬ ì½”ë“œ Enum
â”‚   â”œâ”€â”€ DiaryNotFoundException.java    # 404 ì—ëŸ¬
â”‚   â”œâ”€â”€ DuplicateDiaryEntryException.java  # 409 ì—ëŸ¬
â”‚   â””â”€â”€ UnauthorizedDiaryAccessException.java  # 403 ì—ëŸ¬
â”œâ”€â”€ repository/
â”‚   â””â”€â”€ DiaryRepository.java           # ë°ì´í„° ì ‘ê·¼ ë ˆì´ì–´
â””â”€â”€ service/
    â””â”€â”€ DiaryService.java              # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
```

---

## 4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### 4.1 diary í…Œì´ë¸”
```sql
CREATE TABLE diary (
    id              BIGINT AUTO_INCREMENT PRIMARY KEY,
    member_id       BIGINT NOT NULL,
    date            DATE NOT NULL,
    meal_type       VARCHAR(20) NOT NULL,  -- BREAKFAST, LUNCH, DINNER, SNACK
    content         VARCHAR(500) NOT NULL,
    image_url       VARCHAR(255),
    recipe_id       BIGINT,                -- ì—°ê²°ëœ ë ˆì‹œí”¼ ID
    created_at      DATETIME NOT NULL,
    updated_at      DATETIME,
    
    FOREIGN KEY (member_id) REFERENCES members(id),
    UNIQUE KEY uk_diary_member_date_mealtype (member_id, date, meal_type)
);
```

### 4.2 MealType Enum
```java
public enum MealType {
    BREAKFAST(0),  // ì•„ì¹¨
    LUNCH(1),      // ì ì‹¬
    DINNER(2),     // ì €ë…
    SNACK(3);      // ê°„ì‹
    
    private final int order;  // ì •ë ¬ ìˆœì„œ
}
```

### 4.3 í…Œì´ë¸” ê´€ê³„ë„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Members   â”‚         â”‚    Diary    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”‚ member_id   â”‚
â”‚ email       â”‚         â”‚ date        â”‚
â”‚ nickname    â”‚         â”‚ meal_type   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ content     â”‚
                        â”‚ image_url   â”‚
                        â”‚ recipe_id â”€â”€â”¼â”€â”€â–º ë ˆì‹œí”¼ ì°¸ì¡°
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. API ëª…ì„¸

### 5.1 ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡

| Method | Endpoint | ì„¤ëª… | ì¸ì¦ |
|--------|----------|------|------|
| GET | `/api/v1/diary` | ì›”ë³„ ìº˜ë¦°ë” ì¡°íšŒ | âœ… |
| GET | `/api/v1/diary/daily` | ì¼ë³„ ì‹ë‹¨ ì¡°íšŒ | âœ… |
| POST | `/api/v1/diary` | ì‹ë‹¨ ìƒì„± | âœ… |
| PUT | `/api/v1/diary/{id}` | ì‹ë‹¨ ìˆ˜ì • | âœ… |
| DELETE | `/api/v1/diary/{id}` | ì‹ë‹¨ ì‚­ì œ | âœ… |

### 5.2 ìš”ì²­/ì‘ë‹µ ì˜ˆì‹œ

#### ì›”ë³„ ìº˜ë¦°ë” ì¡°íšŒ (DIARY-01)
```http
GET /api/v1/diary?year=2024&month=12
```

```json
// Response
{
  "year": 2024,
  "month": 12,
  "dailyEntries": [
    {
      "date": "2024-12-01",
      "hasBreakfast": true,
      "hasLunch": true,
      "hasDinner": false,
      "hasSnack": false,
      "thumbnailUrl": "https://s3.../breakfast.jpg"
    },
    {
      "date": "2024-12-02",
      "hasBreakfast": true,
      "hasLunch": true,
      "hasDinner": true,
      "hasSnack": true,
      "thumbnailUrl": "https://s3.../lunch.jpg"
    }
  ]
}
```

#### ì¼ë³„ ì‹ë‹¨ ì¡°íšŒ (DIARY-02)
```http
GET /api/v1/diary/daily?date=2024-12-06
```

```json
// Response
{
  "date": "2024-12-06",
  "diaries": [
    {
      "id": 1,
      "mealType": "BREAKFAST",
      "content": "í† ìŠ¤íŠ¸ì™€ ìŠ¤í¬ë¨ë¸” ì—ê·¸",
      "imageUrl": "https://s3.../img.jpg",
      "recipeId": null,
      "createdAt": "2024-12-06T07:30:00"
    },
    {
      "id": 2,
      "mealType": "LUNCH",
      "content": "ëœì¥ì°Œê°œ ë ˆì‹œí”¼",
      "imageUrl": "https://s3.../recipe.jpg",
      "recipeId": 42,
      "createdAt": "2024-12-06T12:00:00"
    }
  ]
}
```

#### ì‹ë‹¨ ìƒì„± (DIARY-03)
```http
POST /api/v1/diary
Content-Type: application/json

{
  "date": "2024-12-06",
  "mealType": "BREAKFAST",
  "content": "í† ìŠ¤íŠ¸ì™€ ì˜¤ë¯ˆë ›",
  "imageUrl": "https://s3.../breakfast.jpg",
  "recipeId": null
}
```

```json
// Response (201 Created)
{
  "id": 1,
  "memberId": 123,
  "date": "2024-12-06",
  "mealType": "BREAKFAST",
  "content": "í† ìŠ¤íŠ¸ì™€ ì˜¤ë¯ˆë ›",
  "imageUrl": "https://s3.../breakfast.jpg",
  "recipeId": null,
  "createdAt": "2024-12-06T08:30:00",
  "updatedAt": "2024-12-06T08:30:00"
}
```

#### ë ˆì‹œí”¼ì—ì„œ ë‹¤ì´ì–´ë¦¬ ì¶”ê°€ (DIARY-06)
```http
POST /api/v1/diary
Content-Type: application/json

{
  "date": "2024-12-06",
  "mealType": "DINNER",
  "content": "ê¹€ì¹˜ì°Œê°œ",
  "imageUrl": "https://recipe.../kimchi.jpg",
  "recipeId": 42
}
```

---

## 6. í•µì‹¬ êµ¬í˜„ ìƒì„¸

### 6.1 Diary ì—”í‹°í‹°

```java
@Entity
@Table(
    name = "diary",
    uniqueConstraints = @UniqueConstraint(
        columnNames = {"member_id", "date", "meal_type"}
    )
)
@EntityListeners(AuditingEntityListener.class)
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@AllArgsConstructor
@Builder
public class Diary {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "member_id", nullable = false)
    private Member member;
    
    @Column(name = "date", nullable = false)
    private LocalDate date;
    
    @Enumerated(EnumType.STRING)
    @Column(name = "meal_type", nullable = false, length = 20)
    private MealType mealType;
    
    @Column(name = "content", nullable = false, length = 500)
    private String content;
    
    @Column(name = "image_url", length = 255)
    private String imageUrl;
    
    @Column(name = "recipe_id")
    private Long recipeId;
    
    @CreatedDate
    private LocalDateTime createdAt;
    
    @LastModifiedDate
    private LocalDateTime updatedAt;
    
    // ìˆ˜ì • ë©”ì„œë“œ
    public void update(String content, String imageUrl, Long recipeId) {
        this.content = content;
        this.imageUrl = imageUrl;
        this.recipeId = recipeId;
    }
}
```

### 6.2 DiaryService í•µì‹¬ ë¡œì§

```java
@Service
@RequiredArgsConstructor
@Transactional(readOnly = true)
public class DiaryService {
    
    private final DiaryRepository diaryRepository;
    private final MemberRepository memberRepository;
    
    /**
     * DIARY-01: ì›”ë³„ ìº˜ë¦°ë” ì¡°íšŒ
     */
    public DiaryDto.MonthlyCalendarResponse getMonthlyCalendar(
            Long memberId, int year, int month) {
        
        Member member = getMemberById(memberId);
        
        // í•´ë‹¹ ì›”ì˜ ëª¨ë“  ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ (MealType ìˆœì„œëŒ€ë¡œ ì •ë ¬)
        List<Diary> diaries = diaryRepository
            .findByMemberAndYearMonth(member, year, month);
        
        return new DiaryDto.MonthlyCalendarResponse(year, month, diaries);
    }
    
    /**
     * DIARY-03: ì‹ë‹¨ ìƒì„± (ì¤‘ë³µ ì²´í¬)
     */
    @Transactional
    public DiaryDto.Response createDiary(
            Long memberId, DiaryDto.CreateRequest request) {
        
        Member member = getMemberById(memberId);
        
        // ì¤‘ë³µ ì²´í¬: ê°™ì€ ë‚ ì§œ + ê°™ì€ ì‹ì‚¬ ì‹œê°„
        if (diaryRepository.existsByMemberAndDateAndMealType(
                member, request.getDate(), request.getMealType())) {
            throw new DuplicateDiaryEntryException();
        }
        
        Diary diary = Diary.builder()
                .member(member)
                .date(request.getDate())
                .mealType(request.getMealType())
                .content(request.getContent())
                .imageUrl(request.getImageUrl())
                .recipeId(request.getRecipeId())
                .build();
        
        return new DiaryDto.Response(diaryRepository.save(diary));
    }
    
    /**
     * DIARY-04: ì‹ë‹¨ ìˆ˜ì • (ê¶Œí•œ ì²´í¬)
     */
    @Transactional
    public DiaryDto.Response updateDiary(
            Long memberId, Long diaryId, DiaryDto.UpdateRequest request) {
        
        Diary diary = getDiaryById(diaryId);
        
        // ê¶Œí•œ ì²´í¬
        if (!diary.getMember().getId().equals(memberId)) {
            throw new UnauthorizedDiaryAccessException();
        }
        
        diary.update(
            request.getContent(),
            request.getImageUrl(),
            request.getRecipeId()
        );
        
        return new DiaryDto.Response(diary);
    }
}
```

### 6.3 DiaryRepository ì»¤ìŠ¤í…€ ì¿¼ë¦¬

```java
@Repository
public interface DiaryRepository extends JpaRepository<Diary, Long> {
    
    /**
     * ì›”ë³„ ì¡°íšŒ (MealType ìˆœì„œëŒ€ë¡œ ì •ë ¬)
     */
    @Query("SELECT d FROM Diary d WHERE d.member = :member " +
           "AND YEAR(d.date) = :year AND MONTH(d.date) = :month " +
           "ORDER BY d.date ASC, " +
           "CASE d.mealType " +
           "WHEN com.capstone.web.diary.domain.MealType.BREAKFAST THEN 0 " +
           "WHEN com.capstone.web.diary.domain.MealType.LUNCH THEN 1 " +
           "WHEN com.capstone.web.diary.domain.MealType.DINNER THEN 2 " +
           "WHEN com.capstone.web.diary.domain.MealType.SNACK THEN 3 " +
           "END ASC")
    List<Diary> findByMemberAndYearMonth(
        @Param("member") Member member,
        @Param("year") int year,
        @Param("month") int month
    );
    
    /**
     * ì¼ë³„ ì¡°íšŒ (MealType ìˆœì„œëŒ€ë¡œ ì •ë ¬)
     */
    List<Diary> findByMemberAndDateOrderByMealTypeAsc(
        Member member, LocalDate date
    );
    
    /**
     * ì¤‘ë³µ ì²´í¬
     */
    boolean existsByMemberAndDateAndMealType(
        Member member, LocalDate date, MealType mealType
    );
}
```

---

## 7. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

### 7.1 ìº˜ë¦°ë” ë·° ìƒì„± ë¡œì§

```java
public static class MonthlyCalendarResponse {
    private final int year;
    private final int month;
    private final List<DailyEntry> dailyEntries;
    
    public MonthlyCalendarResponse(int year, int month, List<Diary> diaries) {
        this.year = year;
        this.month = month;
        
        // ë‚ ì§œë³„ë¡œ ê·¸ë£¹í•‘
        Map<LocalDate, List<Diary>> groupedByDate = diaries.stream()
            .collect(Collectors.groupingBy(Diary::getDate));
        
        // ê° ë‚ ì§œë³„ DailyEntry ìƒì„±
        this.dailyEntries = groupedByDate.entrySet().stream()
            .map(entry -> new DailyEntry(entry.getKey(), entry.getValue()))
            .sorted(Comparator.comparing(DailyEntry::getDate))
            .collect(Collectors.toList());
    }
}

public static class DailyEntry {
    private final LocalDate date;
    private final boolean hasBreakfast;
    private final boolean hasLunch;
    private final boolean hasDinner;
    private final boolean hasSnack;
    private final String thumbnailUrl;
    
    public DailyEntry(LocalDate date, List<Diary> diaries) {
        this.date = date;
        
        // ê° ì‹ì‚¬ ì‹œê°„ë³„ ì¡´ì¬ ì—¬ë¶€ ì²´í¬
        this.hasBreakfast = diaries.stream()
            .anyMatch(d -> d.getMealType() == MealType.BREAKFAST);
        this.hasLunch = diaries.stream()
            .anyMatch(d -> d.getMealType() == MealType.LUNCH);
        this.hasDinner = diaries.stream()
            .anyMatch(d -> d.getMealType() == MealType.DINNER);
        this.hasSnack = diaries.stream()
            .anyMatch(d -> d.getMealType() == MealType.SNACK);
        
        // ëŒ€í‘œ ì¸ë„¤ì¼ (ì²« ë²ˆì§¸ ì´ë¯¸ì§€)
        this.thumbnailUrl = diaries.stream()
            .filter(d -> d.getImageUrl() != null)
            .findFirst()
            .map(Diary::getImageUrl)
            .orElse(null);
    }
}
```

### 7.2 ë ˆì‹œí”¼ ì—°ë™ íë¦„ (DIARY-06)

```
[ë ˆì‹œí”¼ ìƒì„¸ í˜ì´ì§€]
        â”‚
        â–¼
[ë‹¤ì´ì–´ë¦¬ì— ì¶”ê°€ ë²„íŠ¼ í´ë¦­]
        â”‚
        â–¼
[ë‚ ì§œ & ì‹ì‚¬ ì‹œê°„ ì„ íƒ ëª¨ë‹¬]
        â”‚
        â–¼
[POST /api/v1/diary]
{
  "date": "2024-12-06",
  "mealType": "DINNER",
  "content": "ê¹€ì¹˜ì°Œê°œ",        // ë ˆì‹œí”¼ ì œëª©
  "imageUrl": "recipe_image",   // ë ˆì‹œí”¼ ì´ë¯¸ì§€
  "recipeId": 42               // ë ˆì‹œí”¼ ID (ì—°ê²°)
}
        â”‚
        â–¼
[ë‹¤ì´ì–´ë¦¬ì—ì„œ ë ˆì‹œí”¼ ì°¸ì¡° ê°€ëŠ¥]
```

---

## 8. ë””ìì¸ íŒ¨í„´

### 8.1 Layered Architecture
```
Controller (REST API)
    â†“
Service (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
    â†“
Repository (ë°ì´í„° ì ‘ê·¼)
    â†“
Database
```

### 8.2 DTO Pattern
- ìš”ì²­/ì‘ë‹µ ë¶„ë¦¬
- ë‚´ë¶€ static classë¡œ ê·¸ë£¹í™”
- Entity ë…¸ì¶œ ë°©ì§€

### 8.3 Builder Pattern
- Lombok @Builder ì‚¬ìš©
- ë³µì¡í•œ ê°ì²´ ìƒì„± ê°„ì†Œí™”

### 8.4 Repository Pattern
- Spring Data JPA í™œìš©
- ì»¤ìŠ¤í…€ ì¿¼ë¦¬ ë©”ì„œë“œ ì •ì˜

### 8.5 Error Code Enumeration Pattern
```java
public enum DiaryErrorCode {
    DIARY_NOT_FOUND(HttpStatus.NOT_FOUND, "DIARY_NOT_FOUND", 
        "ì‹ë‹¨ ê¸°ë¡ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    DUPLICATE_DIARY_ENTRY(HttpStatus.CONFLICT, "DUPLICATE_DIARY_ENTRY", 
        "í•´ë‹¹ ë‚ ì§œ, í•´ë‹¹ ì‹ì‚¬ ì‹œê°„ì— ì´ë¯¸ ê¸°ë¡ì´ ì¡´ì¬í•©ë‹ˆë‹¤"),
    UNAUTHORIZED_DIARY_ACCESS(HttpStatus.FORBIDDEN, "UNAUTHORIZED_DIARY_ACCESS", 
        "ì‹ë‹¨ ê¸°ë¡ì— ëŒ€í•œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤");
    
    private final HttpStatus status;
    private final String code;
    private final String message;
}
```

---

## 9. ì˜ˆìƒ ì§ˆë¬¸ ë° ë‹µë³€

### Q1: ì™œ í•˜ë£¨ì— ê°™ì€ ì‹ì‚¬ ì‹œê°„ì— ì—¬ëŸ¬ ê¸°ë¡ì„ ëª»í•˜ë‚˜ìš”?
**A:** 
- **ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­**: í•˜ë£¨ 4ë¼ (ì•„ì¹¨, ì ì‹¬, ì €ë…, ê°„ì‹) ê´€ë¦¬
- **UX ê´€ì **: ìº˜ë¦°ë” UIì—ì„œ ê° ì‹ì‚¬ ì‹œê°„ë³„ ìƒíƒœë¥¼ í‘œì‹œ
- **ëŒ€ì•ˆ**: content í•„ë“œì— ì—¬ëŸ¬ ë©”ë‰´ë¥¼ í•œ ë²ˆì— ê¸°ë¡

### Q2: MealTypeì˜ order í•„ë“œëŠ” ì™œ í•„ìš”í•œê°€ìš”?
**A:** 
- ë°ì´í„°ë² ì´ìŠ¤ ì •ë ¬ ì‹œ ì•„ì¹¨â†’ì ì‹¬â†’ì €ë…â†’ê°„ì‹ ìˆœì„œ ë³´ì¥
- JPQL CASE ë¬¸ì—ì„œ ì •ë ¬ ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©
- í”„ë¡ íŠ¸ì—”ë“œ í‘œì‹œ ìˆœì„œ ì¼ê´€ì„± ìœ ì§€

### Q3: ë ˆì‹œí”¼ ì—°ë™ (recipeId)ì˜ ì¥ì ì€?
**A:**
1. **ì›ë³¸ ì¶”ì **: ë‹¤ì´ì–´ë¦¬ì—ì„œ ë ˆì‹œí”¼ë¡œ ì´ë™ ê°€ëŠ¥
2. **ë°ì´í„° ì¼ê´€ì„±**: ë ˆì‹œí”¼ ìˆ˜ì • ì‹œ ë‹¤ì´ì–´ë¦¬ ì˜í–¥ ì—†ìŒ
3. **ì„ íƒì  ì—°ë™**: null í—ˆìš©ìœ¼ë¡œ ììœ  ê¸°ë¡ë„ ê°€ëŠ¥

### Q4: ì›”ë³„ ì¡°íšŒ ì„±ëŠ¥ ì´ìŠˆëŠ” ì—†ë‚˜ìš”?
**A:**
- **í˜„ì¬**: í•œ ë‹¬ ìµœëŒ€ 120ê°œ (30ì¼ Ã— 4ë¼)
- **ìµœì í™”**: 
  - Unique ì¸ë±ìŠ¤ë¡œ ë¹ ë¥¸ ì¤‘ë³µ ì²´í¬
  - Lazy Loadingìœ¼ë¡œ Member í˜ì¹˜ ìµœì†Œí™”
- **ê°œì„  ë°©í–¥**: í˜ì´ì§•, ìºì‹± ê³ ë ¤ ê°€ëŠ¥

### Q5: ê¶Œí•œ ì²´í¬ëŠ” ì–´ë–»ê²Œ í•˜ë‚˜ìš”?
**A:**
```java
if (!diary.getMember().getId().equals(memberId)) {
    throw new UnauthorizedDiaryAccessException();
}
```
- JWTì—ì„œ ì¶”ì¶œí•œ memberIdì™€ diaryì˜ member.id ë¹„êµ
- ë¶ˆì¼ì¹˜ ì‹œ 403 Forbidden ì‘ë‹µ

### Q6: ìº˜ë¦°ë” ë·°ì˜ thumbnailUrl ì„ íƒ ê¸°ì¤€ì€?
**A:**
- í•´ë‹¹ ë‚ ì§œì˜ **ì²« ë²ˆì§¸ ì´ë¯¸ì§€** ì‚¬ìš©
- ìš°ì„ ìˆœìœ„: ì•„ì¹¨ â†’ ì ì‹¬ â†’ ì €ë… â†’ ê°„ì‹
- ì´ë¯¸ì§€ ì—†ìœ¼ë©´ null

### Q7: JPA Auditing (@CreatedDate, @LastModifiedDate)ì˜ ë™ì‘ì€?
**A:**
```java
@Configuration
@EnableJpaAuditing
public class JpaAuditingConfig { }

@EntityListeners(AuditingEntityListener.class)
public class Diary {
    @CreatedDate
    private LocalDateTime createdAt;  // INSERT ì‹œ ìë™ ì„¤ì •
    
    @LastModifiedDate
    private LocalDateTime updatedAt;  // UPDATE ì‹œ ìë™ ê°±ì‹ 
}
```

### Q8: í”„ë¡ íŠ¸ì—”ë“œì™€ì˜ ë‚ ì§œ ì²˜ë¦¬ ê·œì•½ì€?
**A:**
- **ìš”ì²­**: `YYYY-MM-DD` ë¬¸ìì—´ (ISO 8601)
- **ì‘ë‹µ**: `YYYY-MM-DD` ë¬¸ìì—´ (LocalDate)
- **Timezone**: ì„œë²„ ê¸°ì¤€ Asia/Seoul
- **Jackson ì„¤ì •**: ìë™ ë³€í™˜

---

## ğŸ“ ê´€ë ¨ íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ê²½ë¡œ | ìš©ë„ |
|------|------|------|
| DiaryController.java | `.../diary/controller/` | REST API |
| DiaryService.java | `.../diary/service/` | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ |
| Diary.java | `.../diary/domain/` | JPA ì—”í‹°í‹° |
| DiaryDto.java | `.../diary/dto/` | ìš”ì²­/ì‘ë‹µ DTO |
| DiaryRepository.java | `.../diary/repository/` | ë°ì´í„° ì ‘ê·¼ |
| DiaryErrorCode.java | `.../diary/exception/` | ì—ëŸ¬ ì½”ë“œ |
| DiaryNotFoundException.java | `.../diary/exception/` | 404 ì˜ˆì™¸ |
| DuplicateDiaryEntryException.java | `.../diary/exception/` | 409 ì˜ˆì™¸ |
| UnauthorizedDiaryAccessException.java | `.../diary/exception/` | 403 ì˜ˆì™¸ |

---

## ğŸ§ª í…ŒìŠ¤íŠ¸

### í…ŒìŠ¤íŠ¸ í˜„í™©
- **DiaryServiceTest**: 13ê°œ í…ŒìŠ¤íŠ¸ (ëª¨ë‘ í†µê³¼)
- **DiaryControllerTest**: 13ê°œ API í†µí•© í…ŒìŠ¤íŠ¸ (ëª¨ë‘ í†µê³¼)

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì˜ˆì‹œ
```java
@Test
void createDiary_duplicateEntry_throwsException() {
    // Given: ì´ë¯¸ ê°™ì€ ë‚ ì§œ+ì‹ì‚¬ ì‹œê°„ì— ê¸°ë¡ ì¡´ì¬
    given(diaryRepository.existsByMemberAndDateAndMealType(...))
        .willReturn(true);
    
    // When & Then
    assertThrows(DuplicateDiaryEntryException.class, () ->
        diaryService.createDiary(memberId, request)
    );
}
```
